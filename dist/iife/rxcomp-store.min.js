/**
 * @license rxcomp-store v1.0.0-beta.10
 * (c) 2020 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */
this.rxcomp=this.rxcomp||{},this.rxcomp.form=function(t,e,n,i,r){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var a=function(t){function e(){var e;return(e=t.apply(this,arguments)||this).active=!1,e}return s(e,t),e.prototype.onToggle=function(){this.active=!this.active,this.pushChanges()},e}(e.Component);a.meta={selector:"json-component",inputs:["item"],template:'\n\t\t<div class="rxc-block">\n\t\t\t<div class="rxc-head">\n\t\t\t\t<span class="rxc-head__title" (click)="onToggle()">\n\t\t\t\t\t<span *if="!active">+ json </span>\n\t\t\t\t\t<span *if="active">- json </span>\n\t\t\t\t\t<span [innerHTML]="item"></span>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<ul class="rxc-list" *if="active">\n\t\t\t\t<li class="rxc-list__item">\n\t\t\t\t\t<span class="rxc-list__value" [innerHTML]="item | json"></span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>'};var c=function(){function t(){}return t.encode=function(t){var e=null;try{var n=new Map,i=JSON.stringify(t,(function(t,e){if("object"==typeof e&&null!=e){if(n.has(e))return;n.set(e,!0)}return e}));e=btoa(encodeURIComponent(i))}catch(e){console.warn("StorageService.encode.error",t,e)}return e},t.decode=function(t){var e;if(t)try{e=JSON.parse(decodeURIComponent(atob(t)))}catch(n){e=t}return e},t.isSupported=function(t){var e,n=!1;try{e=window[t];var i="__storage_test__";e.setItem(i,i),e.removeItem(i),n=!0}catch(t){n=t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&Boolean(e&&0!==e.length)}return n},t}();c.supported=!1;var u=function(t){function e(){return t.apply(this,arguments)||this}return s(e,t),e.clear=function(){var t=this;this.toRawArray().forEach((function(e){t.setter(e.name,"",-1)}))},e.delete=function(t){this.setter(t,"",-1)},e.exist=function(t){return-1!==document.cookie.indexOf(";"+t+"=")||0===document.cookie.indexOf(t+"=")},e.get=function(t){return this.decode(this.getRaw(t))},e.set=function(t,e,n){this.setter(t,this.encode(e),n)},e.getRaw=function(t){var e=null,n=this.toRawArray().find((function(e){return e.name===t}));return n&&(e=n.value),e},e.setRaw=function(t,e,n){this.setter(t,e,n)},e.toArray=function(){var t=this;return this.toRawArray().map((function(e){return e.value=t.decode(e.value),e}))},e.toRawArray=function(){return document.cookie.split(";").map((function(t){var e=t.split("=");return{name:e[0].trim(),value:e[1]?e[1].trim():null}})).filter((function(t){return""!==t.name}))},e.setter=function(t,e,n){var i;if(n){var r=new Date;r.setTime(r.getTime()+24*n*60*60*1e3),i="; expires="+r.toUTCString()}else i="";document.cookie=t+"="+e+i+"; path=/",this.items$.next(this.toArray())},e.isSupported=function(){return"undefined"!=typeof window&&void 0!==window.document},e}(c);u.items$=new i.ReplaySubject(1);var l=function(t){function e(){var e;return(e=t.apply(this,arguments)||this).active=!1,e.items=[],e}s(e,t);var i=e.prototype;return i.onInit=function(){var t=this;this.items=u.toArray(),u.items$.pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(e){t.items=e,t.pushChanges()}))},i.onToggle=function(){this.active=!this.active,this.pushChanges()},i.onClear=function(){u.clear()},i.onRemove=function(t){u.delete(t.name)},e}(e.Component);l.meta={selector:"cookie-storage-component",template:'\n\t\t<div class="rxc-block">\n\t\t\t<div class="rxc-head">\n\t\t\t\t<span class="rxc-head__title" (click)="onToggle()">\n\t\t\t\t\t<span *if="!active">+ cookie</span>\n\t\t\t\t\t<span *if="active">- cookie</span>\n\t\t\t\t\t<span [innerHTML]="\' {\' + items.length + \')\'"></span>\n\t\t\t\t</span>\n\t\t\t\t<span class="rxc-head__remove" (click)="onClear()">x</span>\n\t\t\t</div>\n\t\t\t<ul class="rxc-list" *if="active">\n\t\t\t\t<li class="rxc-list__item" *for="let item of items">\n\t\t\t\t\t<span class="rxc-list__name" [innerHTML]="item.name"></span>\n\t\t\t\t\t<span class="rxc-list__value" [innerHTML]="item.value | json"></span>\n\t\t\t\t\t<span class="rxc-list__remove" (click)="onRemove(item)">x</span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>'};var p=function(t){function e(){return t.apply(this,arguments)||this}return s(e,t),e.clear=function(){this.isSupported()&&(localStorage.clear(),this.items$.next(this.toArray()))},e.delete=function(t){this.isSupported()&&(localStorage.removeItem(t),this.items$.next(this.toArray()))},e.exist=function(t){return!!this.isSupported()&&void 0!==localStorage.getItem(t)},e.get=function(t){return this.decode(this.getRaw(t))},e.set=function(t,e){this.setRaw(t,this.encode(e))},e.getRaw=function(t){var e=null;return this.isSupported()&&(e=localStorage.getItem(t)),e},e.setRaw=function(t,e){e&&this.isSupported()&&(localStorage.setItem(t,e),this.items$.next(this.toArray()))},e.toArray=function(){var t=this;return this.toRawArray().map((function(e){return e.value=t.decode(e.value),e}))},e.toRawArray=function(){var t=this;return this.isSupported()?Object.keys(localStorage).map((function(e){return{name:e,value:t.getRaw(e)}})):[]},e.isSupported=function(){return!!this.supported||c.isSupported("localStorage")},e}(c);p.items$=new i.ReplaySubject(1);var f=function(t){function e(){var e;return(e=t.apply(this,arguments)||this).active=!1,e.items=[],e}s(e,t);var i=e.prototype;return i.onInit=function(){var t=this;this.items=p.toArray(),p.items$.pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(e){t.items=e,t.pushChanges()}))},i.onToggle=function(){this.active=!this.active,this.pushChanges()},i.onClear=function(){p.clear()},i.onRemove=function(t){p.delete(t.name)},e}(e.Component);f.meta={selector:"local-storage-component",template:'\n\t\t<div class="rxc-block">\n\t\t\t<div class="rxc-head">\n\t\t\t\t<span class="rxc-head__title" (click)="onToggle()">\n\t\t\t\t\t<span *if="!active">+ localStorage</span>\n\t\t\t\t\t<span *if="active">- localStorage</span>\n\t\t\t\t\t<span [innerHTML]="\' {\' + items.length + \')\'"></span>\n\t\t\t\t</span>\n\t\t\t\t<span class="rxc-head__remove" (click)="onClear()">x</span>\n\t\t\t</div>\n\t\t\t<ul class="rxc-list" *if="active">\n\t\t\t\t<li class="rxc-list__item" *for="let item of items">\n\t\t\t\t\t<span class="rxc-list__name" [innerHTML]="item.name"></span>\n\t\t\t\t\t<span class="rxc-list__value" [innerHTML]="item.value | json"></span>\n\t\t\t\t\t<span class="rxc-list__remove" (click)="onRemove(item)">x</span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>'};var h=function(t){function e(){return t.apply(this,arguments)||this}return s(e,t),e.clear=function(){this.isSupported()&&(sessionStorage.clear(),this.items$.next(this.toArray()))},e.delete=function(t){this.isSupported()&&(sessionStorage.removeItem(t),this.items$.next(this.toArray()))},e.exist=function(t){return!!this.isSupported()&&void 0!==sessionStorage.getItem(t)},e.get=function(t){return this.decode(this.getRaw(t))},e.set=function(t,e){this.setRaw(t,this.encode(e))},e.getRaw=function(t){var e=null;return this.isSupported()&&(e=sessionStorage.getItem(t)),e},e.setRaw=function(t,e){e&&this.isSupported()&&(sessionStorage.setItem(t,e),this.items$.next(this.toArray()))},e.toArray=function(){var t=this;return this.toRawArray().map((function(e){return e.value=t.decode(e.value),e}))},e.toRawArray=function(){var t=this;return this.isSupported()?Object.keys(sessionStorage).map((function(e){return{name:e,value:t.getRaw(e)}})):[]},e.isSupported=function(){return!!this.supported||c.isSupported("sessionStorage")},e}(c);h.items$=new i.ReplaySubject(1);var m=function(t){function e(){var e;return(e=t.apply(this,arguments)||this).active=!1,e.items=[],e}s(e,t);var i=e.prototype;return i.onInit=function(){var t=this;this.items=h.toArray(),h.items$.pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(e){t.items=e,t.pushChanges()}))},i.onToggle=function(){this.active=!this.active,this.pushChanges()},i.onClear=function(){h.clear()},i.onRemove=function(t){h.delete(t.name)},e}(e.Component);m.meta={selector:"session-storage-component",template:'\n\t\t<div class="rxc-block">\n\t\t\t<div class="rxc-head">\n\t\t\t\t<span class="rxc-head__title" (click)="onToggle()">\n\t\t\t\t\t<span *if="!active">+ sessionStorage</span>\n\t\t\t\t\t<span *if="active">- sessionStorage</span>\n\t\t\t\t\t<span [innerHTML]="\' {\' + items.length + \')\'"></span>\n\t\t\t\t</span>\n\t\t\t\t<span class="rxc-head__remove" (click)="onClear()">x</span>\n\t\t\t</div>\n\t\t\t<ul class="rxc-list" *if="active">\n\t\t\t\t<li class="rxc-list__item" *for="let item of items">\n\t\t\t\t\t<span class="rxc-list__name" [innerHTML]="item.name"></span>\n\t\t\t\t\t<span class="rxc-list__value" [innerHTML]="item.value | json"></span>\n\t\t\t\t\t<span class="rxc-list__remove" (click)="onRemove(item)">x</span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>'};var v=function(t){function e(){return t.apply(this,arguments)||this}return s(e,t),e.transform=function(t){var e=new Map;return JSON.stringify(t,(function(t,n){if("object"==typeof n&&null!=n){if(e.has(n))return"#ref";e.set(n,!0)}return n}),2)},e}(e.Pipe);v.meta={name:"json"};var d,y=[a,l,f,m],g=[v],S=function(t){function e(){return t.apply(this,arguments)||this}return s(e,t),e}(e.Module);S.meta={declarations:[].concat(y,g),exports:[].concat(y,g)},(d=t.StoreType||(t.StoreType={}))[d.Memory=1]="Memory",d[d.Session=2]="Session",d[d.Local=3]="Local",d[d.Cookie=4]="Cookie";var x=function(){function e(e,n,o){void 0===e&&(e={}),void 0===n&&(n=t.StoreType.Memory),void 0===o&&(o="store"),this.type=n,this.key="rxcomp_"+o,e.busy=!1,e.error=null;var s=new i.BehaviorSubject(e);this.next=function(t){return function(e){t.next(r.produce(t.getValue(),(function(t){return"function"==typeof e&&e(t),t})))}}(s),this.nextError=function(t){return function(e){return t.next(r.produce(t.getValue(),(function(t){return t.error=e,t.busy=!1,t}))),i.of(e)}}(s),this.select=function(t){return function(e){return e(t.getValue())}}(s),this.state$=s.asObservable()}var s,a,c,l=e.prototype;return l.busy$=function(){var t=this;return i.of(null).pipe(n.filter((function(){return!t.select((function(t){return t.busy}))&&(t.state=function(t){t.busy=!0,t.error=null},!0)})))},l.cached$=function(e){var r=this;return i.of(null).pipe(n.map((function(){var n=null;return r.type===t.StoreType.Local?n=p.get(r.key):r.type===t.StoreType.Session?n=h.get(r.key):r.type===t.StoreType.Cookie&&(n=u.get(r.key)),n&&"function"==typeof e&&(n=e(n)),n})),n.filter((function(t){return null!=t})))},l.select$=function(t){return this.state$.pipe(n.map(t),n.distinctUntilChanged())},l.select=function(t){},l.next=function(t){},l.nextError=function(t){return i.of()},l.reducer=function(e){var r=this;return function(o){return i.defer((function(){return o.pipe(n.map((function(n){return"function"==typeof e&&(r.state=function(i){i.error=null,e(n,i),i.busy=!1,r.type===t.StoreType.Local&&p.set(r.key,i),r.type===t.StoreType.Session&&h.set(r.key,i),r.type===t.StoreType.Cookie&&u.set(r.key,i,365)}),n})))}))}},l.catchState=function(t){var e=this;return function(r){return i.defer((function(){return r.pipe(n.catchError((function(n){return e.state=function(t){t.error=n,t.busy=!1},(n="function"==typeof t?t(n):null)?i.of(n):i.of()})))}))}},s=e,(a=[{key:"state",get:function(){return this.select((function(t){return t}))},set:function(t){this.next(t)}}])&&o(s.prototype,a),c&&o(s,c),e}();return t.CookieStorageComponent=l,t.CookieStorageService=u,t.JsonComponent=a,t.LocalStorageComponent=f,t.LocalStorageService=p,t.SessionStorageComponent=m,t.SessionStorageService=h,t.Store=x,t.StoreModule=S,t.useStore=function(t,e,n){var i=new x(t,e,n);return{state$:i.state$,busy$:i.busy$.bind(i),cached$:i.cached$.bind(i),select$:i.select$.bind(i),select:i.select.bind(i),next:i.next.bind(i),nextError:i.nextError.bind(i),reducer:i.reducer.bind(i),catchState:i.catchState.bind(i)}},t}({},rxcomp,rxjs.operators,rxjs,immer);
//# sourceMappingURL=rxcomp-store.min.js.map