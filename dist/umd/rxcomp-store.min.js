/**
 * @license rxcomp-store v1.0.0-beta.10
 * (c) 2020 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("rxcomp"),require("immer"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define(["exports","rxcomp","immer","rxjs","rxjs/operators"],t):t(((e=e||self).rxcomp=e.rxcomp||{},e.rxcomp.form={}),e.rxcomp,e.immer,e.rxjs,e.rxjs.operators)}(this,(function(e,t,r,o,n){"use strict";var i=function(){function e(){}return e.clear=function(){this.isLocalStorageSupported()&&localStorage.clear()},e.delete=function(e){this.isLocalStorageSupported()&&localStorage.removeItem(e)},e.exist=function(e){return!!this.isLocalStorageSupported()&&void 0!==localStorage.getItem(e)},e.get=function(e){var t=null;if(this.isLocalStorageSupported())try{var r=localStorage.getItem(e);null!=r&&(t=JSON.parse(r))}catch(t){console.log("LocalStorageService.get.error parsing",e,t)}return t},e.set=function(e,t){if(this.isLocalStorageSupported())try{var r=new Map,o=JSON.stringify(t,(function(e,t){if("object"==typeof t&&null!==t){if(r.has(t))return;r.set(t,!0)}return t}));localStorage.setItem(e,o)}catch(r){console.log("LocalStorageService.set.error serializing",e,t,r)}},e.isLocalStorageSupported=function(){if(this.supported)return!0;var e=!1;try{(e="localStorage"in window&&null!==localStorage)?(localStorage.setItem("test","1"),localStorage.removeItem("test")):e=!1}catch(t){e=!1}return this.supported=e,e},e}();i.supported=!1;var s=function(){function e(){}return e.clear=function(){this.isSessionStorageSupported()&&sessionStorage.clear()},e.delete=function(e){this.isSessionStorageSupported()&&sessionStorage.removeItem(e)},e.exist=function(e){return!!this.isSessionStorageSupported()&&void 0!==sessionStorage.getItem(e)},e.get=function(e){var t=null;if(this.isSessionStorageSupported())try{var r=sessionStorage.getItem(e);null!=r&&(t=JSON.parse(r))}catch(t){console.log("SessionStorageService.get.error parsing",e,t)}return t},e.set=function(e,t){if(this.isSessionStorageSupported())try{var r=new Map,o=JSON.stringify(t,(function(e,t){if("object"==typeof t&&null!==t){if(r.has(t))return;r.set(t,!0)}return t}));sessionStorage.setItem(e,o)}catch(r){console.log("SessionStorageService.set.error serializing",e,t,r)}},e.isSessionStorageSupported=function(){if(this.supported)return!0;var e=!1;try{(e="sessionStorage"in window&&null!==sessionStorage)?(sessionStorage.setItem("test","1"),sessionStorage.removeItem("test")):e=!1}catch(t){e=!1}return this.supported=e,e},e}();function u(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}s.supported=!1;var a,c=[],p=[],l=function(e){var t,r;function o(){return e.apply(this,arguments)||this}return r=e,(t=o).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,o}(t.Module);function S(t){return function(r){var o;return t.state=function(n){n.error=null,o=r(n),n.busy=!1,t.type===e.StoreType.Local&&i.set(t.key,n),t.type===e.StoreType.Session&&s.set(t.key,n)},o}}function f(e){return function(t){return e.state=function(e){e.error=t,e.busy=!1},o.of()}}l.meta={declarations:[].concat(c,p),exports:[].concat(c,p)},(a=e.StoreType||(e.StoreType={}))[a.Memory=1]="Memory",a[a.Session=2]="Session",a[a.Local=3]="Local";var g=function(){function t(t,n,i){void 0===t&&(t={}),void 0===n&&(n=e.StoreType.Memory),void 0===i&&(i="store"),this.type=n,this.key="rxcomp_"+i,t.busy=!1,t.error=null;var s=new o.BehaviorSubject(t);this.setState=function(e){return function(t){e.next(r.produce(e.getValue(),(function(e){return"function"==typeof t&&t(e),e})))}}(s),this.state$=s.asObservable()}var n,i,s;return t.prototype.setState=function(e){},n=t,(i=[{key:"state",set:function(e){this.setState(e)}}])&&u(n.prototype,i),s&&u(n,s),t}();e.LocalStorageService=i,e.SessionStorageService=s,e.Store=g,e.StoreModule=l,e.useStore=function(t,r,u){var a=new g(t,r,u);return{busy:function(){return function(e){return o.of(null).pipe(n.filter((function(){var t;return e.state=function(e){(t=e.busy)||(e.busy=!0,e.error=null)},!t})))}(a)},getState:function(t){return function(t,r){return o.of(null).pipe(n.map((function(){var o=null;return t.type===e.StoreType.Local?(o=i.get(t.key))&&"function"==typeof r&&(o=r(o)):t.type===e.StoreType.Session&&(o=s.get(t.key))&&"function"==typeof r&&(o=r(o)),o})),n.filter((function(e){return null!==e})))}(a,t)},setState:S(a),setError:f(a),state$:a.state$}},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=rxcomp-store.min.js.map